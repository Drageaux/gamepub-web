<div class="container py-3">
  <div *ngIf="job">
    <!-- Header -->
    <div class="d-flex flex-row justify-content-between mb-3">
      <h2>
        {{ job.title }}&nbsp;<span class="text-muted fw-normal"
          >#{{ job.jobNumber }}</span
        >
      </h2>
      <a [routerLink]="['../', newJobLink]"
        ><button class="btn btn-primary">New Job</button></a
      >
    </div>
    <hr />
    <div class="row">
      <div class="col-12 col-sm-8">
        <!-- New Comment -->
        <div class="form-group pb-3">
          <input
            type="textarea"
            class="form-control mb-2"
            [(ngModel)]="newComment"
            [ngModelOptions]="{ standalone: true }"
            placeholder="Add a new comment..."
          />
          <div class="btn-group float-end">
            <button class="btn btn-secondary mr-2" (click)="newComment = ''">
              Cancel
            </button>
            <button
              [disabled]="submitting || newComment === ''"
              class="btn btn-success ml-2"
              (click)="postComment()"
            >
              <ng-container *ngIf="submitting; else elseBlock"
                >Commenting...</ng-container
              >
              <ng-template #elseBlock>Comment</ng-template>
            </button>
          </div>
          <div class="clearfix"></div>
        </div>

        <!-- Comments -->
        <div
          *ngFor="let c of comments"
          class="comment bg-white lift-1 p-2 mb-2 border border-1 rounded"
        >
          <div>
            <ng-container *ngIf="c?.user; else anonBlock">
              <a [routerLink]="['', c.user]"
                ><b>{{ c.user }}</b></a
              ></ng-container
            >
            <ng-template #anonBlock> <b>[Anonymous]</b></ng-template
            >&nbsp;<span
              class="text-muted"
              title="{{ c.createdAt | date: 'medium' }}"
              >commented {{ c.createdAt | dateAgo }}</span
            >
          </div>
          <div>
            {{ c.body }}
          </div>
        </div>
      </div>

      <div class="col-12 col-sm-4">Have a submission?</div>
    </div>
  </div>
</div>
